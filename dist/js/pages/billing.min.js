var BILLING=function(t,n,a,e){var s={invoiceReasons:{subscription_create:"Subscription created",subscription_cycle:"Subscription renewal",subscription_update:"Subscription updated",subscription:"Subscription",manual:"Manual payment",upcoming:"Upcoming",subscription_threshold:"Billing threshold reached"}};return t((function(){HELP.waitFor(USER,"current.id",100,(function(){var n=USER.current.planConnections||[];t("#plans-wrapper");if(n.length>0){var a=[];USER.current.stripeCustomerId;n=HELP.sortArrayByObjectValue(n,"payment.lastBillingDate"),t.each(n,(function(n,e){if("SUBSCRIPTION"==e.type){var s=MAIN.planNames[e.planId]||"Subscription",i=e.payment,r=HELP.getCurrencySymbol("en-US",i.currency),l=nextBillDate=lastBillDate=null,o=e.status;"THB"==r&&(r=""),i.cancelAtDate?(nextBillDate=t("<div>",{class:["bill-next"],html:"<strong>Your plan will cancel on:</strong> "+HELP.formatTimestamp(i.cancelAtDate)}),o="SET TO CANCEL"):i.nextBillingDate&&(nextBillDate=t("<div>",{class:["bill-next"],html:"<strong>Renews on:</strong> "+HELP.formatTimestamp(i.nextBillingDate)})),i.lastBillingDate&&(lastBillDate=t("<div>",{class:["bill-last"],html:"<strong>Last billed:</strong> "+HELP.formatTimestamp(i.lastBillingDate)})),["ACTIVE","TRIALING","REQUIRES_PAYMENT"].includes(e.status)&&(!0,l=t("<a>",{href:"#",text:"Manage subscription",class:"trigger-customer-portal link-grey"})),a.push(t('<div class="plan">').append(t("<div>",{class:["name"],html:"<h3>"+HELP.sanitizeHTML(s)+"</h3>"}),t("<div>",{class:["status"],html:"<strong>Status:</strong> "+o}),t("<div>",{class:["amount"],html:"<strong>Amount:</strong> <span>"+i.currency.toUpperCase()+"</span> "+r+HELP.formatCurrency(i.amount)}),nextBillDate,lastBillDate,l))}})),a.length>0&&t("#subscriptions").append(a)}HELP.sendAJAX({url:"https://hook.us1.make.com/xq3ycqbici93ertr6ixfoea3hg9sqsew",data:{env:HELP.getEnvType(),customer_id:USER.current.stripeCustomerId},method:"GET",callbackSuccess:function(n){var a=[];t.each(n,(function(n,e){var i=HELP.formatTimestamp(e.Period.Start,!1,!0),r=HELP.getCurrencySymbol("en-US",e.Amount.Currency),l=null,o=e.Subscription?s.invoiceReasons[e["Billing Reason"]]:"Credits purchased";"THB"==r&&(r=""),e["Paid date"]&&(l=t("<div>",{class:["date-paid"],html:"<strong>Paid:</strong> "+HELP.formatTimestamp(e["Paid date"],!1,!0)})),a.push(t('<div class="plan">').append(t("<div>",{class:["title"],html:"<h3>"+o+" - "+i+"</h3>"}),t("<div>",{class:["number"],html:'<strong>Invoice:</strong> <a href="'+e["Invoice URL"]+'" target="_blank">'+e["Invoice Number"]+"</a>"}),t("<div>",{class:["status"],html:"<strong>Status:</strong> "+e.Status}),t("<div>",{class:["amount"],html:"<span>"+e.Amount.Currency.toUpperCase()+"</span> "+r+HELP.formatCurrency(e.Amount.Paid/100)}),l))})),a.length<1&&(a=t("<p>",{html:"You don't have any invoices yet."})),t("#invoices").append(a)},callbackError:function(t){console.log("error")}})}))})),s}(jQuery,0,this.document);