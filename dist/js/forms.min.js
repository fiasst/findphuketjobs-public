var FORMS=function(e,t,a,n){var r={uploadFields:function(){e(".upload-wrapper").each((function(){var t=!!e(".file-existing .input-placeholder-text",this).text();e(".upload-field",this).toggle(!t),e(".file-existing",this).toggle(t)})),e(".file-existing .file-upload-button").on("click",(function(){var t=e(this).parents(".upload-wrapper");t.find(".file-existing").remove(),t.find(".upload-field").fadeIn(500)}))},toggleCustomInputField:function(e,t,a){e&&e.hasClass("w--redirected-checked")!==a&&e.trigger("click"),t.prop("checked",a)}};return r.editorOptions={toolbar:"undo redo | bullist numlist",plugins:"lists",valid_elements:"p,ul,ol,li,br",valid_styles:{"*":""},pad_empty_with_br:!0,min_height:200,max_height:400,menubar:!1,branding:!1,statusbar:!1,custom_undo_redo_levels:8,setup:function(t){t.on("keydown keyup change",(function(t){let a=this,n=a.getContent({format:"text"}).length,i=e(a.getContainer()),o=Number(e(a).data("data-maxlength"));switch(t.type){case"keydown":if(n>=o){let e=HELP.getKey(t);HELP.allowCommonKeyPress(t,e)||t.preventDefault()}case"change":o&&n>o&&e(a.targetElm).val("");case"keyup":case"change":r.updateCharCount(i,n,o)}})).on("change",(function(a){let n=t.getContent(),r=e(t.targetElm);n.replace(/\t/g,"").replace(/( *&nbsp; *)+/g," ").replace(/ {2,}/g," "),r.val(n),r.trigger("blur")}))},init_instance_callback:function(t){let a=e(t.targetElm),n=(HELP.zeroTrim(t.getContent({format:"raw"})),t.getContent({format:"text"}).length),i=Number(a.attr("data-valid-maxlength")),o=e(t.getContainer());a.addClass("editor-processed"),e(t).data("data-maxlength",i),i&&r.setupCharCount(o,n,i)}},r.setupCharCount=(e,t,a)=>{e.after(`<div class="char-count"><span>${Number(t)}</span> / ${Number(a)}</div>`).parent().addClass("char-count-wrapper")},r.updateCharCount=(e,t,a)=>{e.parent().find(".char-count span").toggleClass("color-danger",t>=Number(a)-20).text(t)},r.ajaxSubmitHandler=(t,a)=>{var n=e(t),r=n.find(".form-submit.clicked"),i=n.attr("data-validation"),o=n.attr("data-form-values-type");if(i&&!HELP.callNestedFunction(i))return console.log("Validation failed"),MAIN.buttonThinking(r,!0),!1;var l=HELP.getFormValues(n,o),s=HELP.getCookie("form-valid");s=s?Number(s):0,s=++s,"formData"==o?l.set("increment",s):l.increment=s,HELP.setCookie("form-valid",s);var c={url:n.attr("action"),method:n.attr("method"),data:l,timeout:12e4,callbackSuccess:function(e){MAIN.thinking(!1),MAIN.handleAjaxResponse(e,n),a&&"function"==typeof a.callbackSuccess&&a.callbackSuccess(e)},callbackError:function(e){MAIN.thinking(!1),console.log("error"),a&&"function"==typeof a.callbackError&&a.callbackError()}};"formData"==o&&(c.processData=!1,c.contentType=!1,c.cache=!1),MAIN.buttonThinking(r),MAIN.thinking(!0,!1),console.log("data: ",c.data),HELP.sendAJAX(c,n)},e((function(){const t=HELP.getSetQuerystring("dest");t&&e("form").find(".fp_redirect").attr("data-redirect","/"+t),e("form").on("submit",(function(){var t=e(this).find(".fp_redirect").attr("data-redirect");t&&localStorage.setItem("fp_redirect",t)}));var n=0;e(".bouncer .input-wrapper").each((function(t,a){var r="error-wrapper-"+n++;e(a).append(e('<div class="error-wrapper" id="'+r+'" />')).find(":input").attr("data-bouncer-target","#"+r)})),r.bouncer=new Bouncer("form.bouncer",{fieldClass:"error",errorClass:"error-text",fieldPrefix:"bouncer-field_",errorPrefix:"bouncer-error_",disableSubmit:!0,customValidations:{editorMaxlength:function(t){if(!e(t).hasClass("editor"))return!1;var a=e(t).parents(".input-wrapper").find("iframe").contents().find("body");return!!a&&a.text().length>Number(e(t).attr("data-valid-maxlength"))}},messages:{missingValue:{checkbox:"This field is required",radio:"Please select an option",select:"Please select an option","select-multiple":"Please select one or more options",default:"This field is required"},patternMismatch:{email:"Please enter a valid email address",url:"Please enter a valid URL (Example: http://example.com)",number:"Please enter a number",color:"Please match the following format: #rrggbb",date:"Please use the YYYY-MM-DD format",time:"Please use the 24-hour time format (Example: 23:00)",month:"Please use the YYYY-MM format (Example: 2065-08)",default:"Please enter a value in the required format"},outOfRange:{over:"Value must not exceed {max} characters",under:"Value must not be lower than {min} characters"},wrongLength:{over:"Value must not exceed {maxLength} characters",under:"Value must not be lower than {minLength} characters"},editorMaxlength:function(t){return"Value must not exceed "+Number(e(t).attr("data-valid-maxlength"))+" characters"},fallback:"There was an error with this field"}}),e("textarea.editor, .select2-field").on("blur",(function(e){r.bouncer.validate(this)})),e(a).on("bouncerShowError bouncerRemoveError",(function(t){e(t.target).parents(".input-wrapper").toggleClass("error","bouncerShowError"==t.type)})).on("bouncerFormValid",(function(t){let a=event.target;e(a).hasClass("ajax")?r.ajaxSubmitHandler(a):a.submit()})),e(".ajax-submit").on("click",".form-submit",(function(t){e(t.target).addClass("clicked")})).on("submit",(function(e){e.preventDefault(),r.ajaxSubmitHandler(event.target)})),e(".w-form-formradioinput--inputType-custom").each((function(){var t=e(this),a=t.siblings(":input"),n=t.hasClass("w--redirected-checked");n&&r.toggleCustomInputField(t,a,n)})),e(":input[data-maxlength]").each((function(){e(this).attr("maxlength",HELP.sanitizeHTML(e(this).attr("data-maxlength")))})),e(".format-ddmmyyyy").on("keyup",(function(t){t&&"Backspace"!=t.key&&"Delete"!=t.key&&e(this).val(HELP.formatDDMMYYYY(e(this).val()))})),e(a).on("keydown",".format-numeric",(function(e){let t=HELP.getKey(e);HELP.allowCommonKeyPress(e,t)||t>=0&&t<=9||e.preventDefault()})).on("change",".format-numeric",(function(t){e(t.target).val(HELP.removeNonNumeric(e(t.target).val()))})),e(a).on("keydown change",".format-email",(function(t,a){var n=e(this).val()||"",r=HELP.getKey(t);n=n.toString().toLowerCase().replace(/\s+/g,"")," "!=r?(!1!==a?n=n.replace(/[^a-z0-9+\-_.@]/gi,""):/[^a-z0-9+\-_.@!()]/gi.test(n)&&(n=""),e(this).val(n.trim())):t.preventDefault()})),e(".format-email").each((function(){e(this).trigger("change",!1)})),e(a).on("focus blur",".format-url",(function(t){var a=e(this).val();"focus"!=t.type||a||e(this).val(HELP.addHttpProtocol(a)),"blur"==t.type&&a.length<9&&e(this).val("")})).on("keydown change",".format-url",(function(t){var a=e(this).val()||"",n=HELP.getKey(t);(a=a.toString().toLowerCase().replace(/\s+/g,""))&&(a=HELP.addHttpProtocol(a))," "!=n?e(this).val(a):t.preventDefault()})),e(".format-url").each((function(){e(this).trigger("change")})),e('.form-submit[name="op"]').on("click",(function(){e(this).parents("form").find(".form-action-op").val(e(this).val())})),e(a).on("languageChanged.weglot",(function(t,a,n){e(".select-list-options").each((function(){var t=e(this).parent(".select-list-wrapper").find("select"),a=0;e(".w-dyn-item",this).each((function(){var n=e("option",t).eq(a);0!=a||n.val()||(a++,n=e("option",t).eq(a)),n.text(e(this).text()).val(e(this).data("lang-en")),a++})),t.hasClass("select2-hidden-accessible")&&(t.select2("destroy"),t.select2(t.data("select2-options")))}))})),USER.getCurrentMember((function(t){e("form .form-submit").removeAttr("disabled"),e(".select-list-options").buildSelectOptions(),e(".select2-field").filter((function(){return!e(this).parents(".select-list-wrapper").length})).createSelect2(),e(":input[data-default-value]").inputAttrDefaultValue(),e(".input-default-value").inputDefaultValue(),r.uploadFields()})),e(".char-count[maxlength]:not(.editor)").charCountTextareas()})),r}(jQuery,0,this.document);$.fn.initEditor=function(){var e=$(this).filter((function(){return $(this).parents(".hide-live").length<1}));if(!(e.length<1)){var t=FORMS.editorOptions;e.each((function(){t.target=this,tinymce.init(t)}))}},$.fn.inputAttrDefaultValue=function(){$(this).each((function(){var e=$(this),t=e.attr("data-default-value");e.val()||("number"==e.attr("type")&&(t=HELP.removeNonNumeric(t)),e.val(HELP.sanitizeHTML(t,!1,!1)).trigger("change"))}))},$.fn.inputDefaultValue=function(){$(this).each((function(){var e=$(this),t=e.text(),a=e.parents(".input-wrapper").find(":input"),n=a.eq(0).attr("type");"checkbox"==n||"radio"==n?a.each((function(){var e=$(this).siblings(`.w-${n}-input`),a=!!t&&t==$(this).val();"checkbox"==n&&(a=!!t&&"false"!==t),FORMS.toggleCustomInputField(e,$(this),a)})):a.val()||(a.hasClass("editor")?a.val(e.html()):a.val(HELP.stripHTMLWithLinebreaks(e.html())),a.trigger("change"))}))},$.fn.buildSelectOptions=function(e){e=e||{},$.each(this,(function(e,t){var a=$(this).parent(".select-list-wrapper"),n=$("select",a),r=$(".input-default-value",a),i=r.text()?r.text():r.attr("data-value"),o=[],l=n.is("select[multiple]");i=l?$(".w-dyn-item",r).map((function(){return $.trim($(this).text())})):$.trim(HELP.sanitizeHTML(i))||"",$(this).find(".w-dyn-item").each((function(){var e=$(this).find(".no-translate"),t=e.text();$(this).data("lang-en",t),e.remove();var a=$.trim($(this).text()),r=a==i&&"selected";l&&(r=$.inArray(a,i)>-1),!a||$.inArray(a,o)>-1||(o.push(a),$("<option />",{value:t,selected:r}).text(a).appendTo(n))})),n.trigger("change"),n.hasClass("select2-field")&&n.createSelect2()}))},$.fn.createSelect2=function(e){e=e||{};var t=this;if(!$(t).length)return!1;HELP.waitFor(jQuery,"fn.select2",100,(function(){var a;$.each(t,(function(t,n){(a=e).placeholder=$(n).attr("placeholder")||"Select...",a.minimumResultsForSearch=e.minimumResultsForSearch||19,a.dropdownParent=$(n).parents("form")||$("body");var r=$(n).find("option[selected]");$(n).attr("multiple")||$(n).prepend('<option value="">'+HELP.sanitizeHTML(a.placeholder)+"</option>"),$(n).select2(a).data("select2-options",a).val(r.length?$(n).val():"").trigger("change").on("change",(function(){$(this).trigger("blur")}))}))}))},$.fn.charCountTextareas=function(){$(this).each((function(){FORMS.setupCharCount($(this),$(this).val().length,$(this).attr("data-valid-maxlength"))})),$(document).on("keyup",this,(function(e){FORMS.updateCharCount($(e.target),$(e.target).val().length,$(e.target).attr("data-valid-maxlength"))}))},jQuery.expr[":"].selectedInput=(e,t,a)=>"checkbox"==e.type||"radio"==e.type?e.checked:["submit","button","reset","hidden"].indexOf(e.type)<0&&e.value;