USER=function($,e,t,n){var r,a={},c="wf-form-update-active-companies-form";return a.current=HELP.getCookie("MSmember")||{},a.updateCurrentUser=function(e){USER.current=USER.current||a.current,$.extend(!0,USER.current,e)},a.getCurrentMember=function(t){if(USER.current=USER.current||a.current,HELP.checkKeyExists(USER,"current.id"))return USER.current;HELP.waitFor(e,"$memberstackDom",50,(function(){e.$memberstackDom.getCurrentMember().then((({data:e})=>(e=e||{},a.updateCurrentUser(e),t&&t(USER.current),USER.current)))}))},a.getMemberJSON=function(t){HELP.waitFor(e,"$memberstackDom",50,(function(){e.$memberstackDom.getMemberJSON().then((({data:e})=>(e=e||{},t&&t(e),e)))}))},a.updateMemberJSON=function(t,n){HELP.waitFor(e,"$memberstackDom",50,(function(){e.$memberstackDom.updateMemberJSON({json:t}).then((({data:e})=>(e=e||{},n&&n(e),e)))}))},a.getMemberPlans=function(e,t,n){if(t=t||a.getCurrentMember(),HELP.checkKeyExists(t,"planConnections")&&t.planConnections.length){var r=t.planConnections;return n&&(r=HELP.filterArrayByObjectValue(r,"status","ACTIVE")),e&&(r=HELP.filterArrayByObjectValue(r,"type",e)),r}return[]},a.checkCompanyLimits=function(e,t){var n=a.getMemberPlans(!1,!1,!0),c=MAIN.planCompanyLimits;return r=1,t&&(e=HELP.filterArrayByObjectValue(e,"state","active")),$.each(n,(function(e,t){c[t.planId]>r&&(r=c[t.planId])})),e.length-r},a.updateActiveCompanies=function(e){if(e.length>r){var t=HELP.pluralize(r,"business","businesses"),n=$("#"+c),a=n.find(".js-company");n.find(".js-num-companies").text(t),$(".form-job-step-2, #company-form-wrapper").remove(),a.hide(),$.each(e,(function(e,t){var r=a.clone().show();$(".js-company-name",r).text(`${t.tradingName} (${t.registeredName})`),$('[type="checkbox"]',r).attr("name","company[]").val(t.itemId),n.find(".checkbox-list").append(r)})),MAIN.openLitbox({title:"Update active businesses",href:"#update-companies-form-wrapper",css:{xxs:{maxWidth:700}}})}},a.formValidateActiveCompanies=function(){var e=$("#"+c),t=HELP.pluralize(r,"business","businesses"),n=e.find('[type="checkbox"]:checked');return!(n.length<1||n.length>r)||(alert(`Please${n.length>r?" only":""} select ${t} that you want to remain active.`),!1)},a.getCurrentMember(),a}(jQuery,this,this.document);