var BILLING=function($,t,e,n){var a={invoiceReasons:{subscription_create:"Subscription created",subscription_cycle:"Subscription renewal",subscription_update:"Subscription updated",subscription:"Subscription",manual:"Manual payment",upcoming:"Upcoming",subscription_threshold:"Billing threshold reached"}};const s=(t,e,n)=>`https://hook.us1.make.com/bg7py9xulyk6m3wyhmg5okn2ctcfkjiw?plan_id=${t}&customer_id=${e}&amount=${n}`;return $((function(){HELP.waitFor(USER,"current.id",100,(function(){var t=USER.current.planConnections||[],e=$("#plans-wrapper");if(t.length<1)e.append('<p>You haven\'t purchased a plan yet. <a href="/pricing">Select a plan</a> to post jobs and start finding candidates.</p>');else{var n=[],r=USER.current.stripeCustomerId;$.each(t,(function(t,e){if("SUBSCRIPTION"==e.type){var a=MAIN.planNames[e.planId],i=e.payment,o=nextBillDate=lastBillDate=null;i.nextBillingDate&&(nextBillDate=$("<div>",{class:["bill-next"],html:"<strong>Your plan renews on</strong> "+HELP.formatTimestamp(i.nextBillingDate)})),i.lastBillingDate&&(lastBillDate=$("<div>",{class:["bill-last"],html:"<strong>Last billing date:</strong> "+HELP.formatTimestamp(i.lastBillingDate)})),"ACTIVE"==e.status?o=$("<a>",{href:s(e.planId,r,i.amount),text:"Cancel subscription",class:"link-cancel"}):"CANCELED"==e.status&&$("#banner-sub-renew").removeClass("hide"),n.push($('<div class="plan">').append($("<div>",{class:["name"],html:"<h3>"+a+"</h3>"}),$("<div>",{class:["status"],html:"<strong>Status:</strong> "+e.status}),$("<div>",{class:["amount"],html:"<span>"+i.currency.toUpperCase()+"</span> "+HELP.getCurrencySymbol("en-US",i.currency)+HELP.formatCurrency(i.amount)}),nextBillDate,lastBillDate,o))}})),n.length>0?$("#subscriptions").append(n):$("#banner-sub-join").removeClass("hide"),$(".link-cancel").on("click",(function(t){t.preventDefault(),HELP.sendAJAX({url:$(this).attr("href"),data:{env:HELP.getEnvType()},method:"GET",callbackSuccess:function(t){var e="success";"CANCELED"!=t.status&&("Something may have gone wrong. If your subscription does not show as <strong>Cancelled</strong>, please contact our team.",e="error"),MAIN.dialog({message:message,type:e,mode:"dialog",options:{title:"Your subscription",actions:[{type:"button",text:"OK",attributes:{class:"button-primary trigger-lbox-close",href:"#"}}]}})},callbackError:function(t){console.log("error")}})}))}HELP.sendAJAX({url:"https://hook.us1.make.com/xq3ycqbici93ertr6ixfoea3hg9sqsew",data:{env:HELP.getEnvType(),customer_id:USER.current.stripeCustomerId},method:"GET",callbackSuccess:function(t){var e=[];$.each(t,(function(t,n){var s=HELP.getCurrencySymbol("en-US",n.Amount.Currency),r=HELP.formatTimestamp(n.Period.Start,!1,!0),i=null,o=n.Subscription?"Subscription":"One-time";n.Period.Start!=n.Period.End&&(r+=" - "+HELP.formatTimestamp(n.Period.End,!1,!0)),n["Paid date"]&&(i=$("<div>",{class:["date-paid"],html:"<strong>Paid:</strong> "+HELP.formatTimestamp(n["Paid date"],!1,!0)})),e.push($('<div class="plan">').append($("<div>",{class:["title"],html:"<h3>"+o+" - "+r+"</h3>"}),$("<div>",{class:["number"],html:'<strong>Invoice:</strong> <a href="'+n["Invoice URL"]+'" target="_blank">'+n["Invoice Number"]+"</a>"}),$("<div>",{class:["status"],html:"<strong>Status:</strong> "+n.Status}),$("<div>",{class:["status"],html:"<strong>Type:</strong> "+a.invoiceReasons[n["Billing Reason"]]}),$("<div>",{class:["amount"],html:"<span>"+n.Amount.Currency.toUpperCase()+"</span> "+s+HELP.formatCurrency(n.Amount.Paid/100)}),i))})),e.length<1&&(e=$("<p>",{html:"You don't have any invoices yet."})),$("#invoices").append(e)},callbackError:function(t){console.log("error")}})}))})),a}(jQuery,0,this.document);