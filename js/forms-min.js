var FORMS=function($,t,e,n){var a={uploadFields:function(){$(".upload-wrapper").each((function(){var t=!!$(this).find(".file-existing .file-upload-text").text();$(".upload-field",this).toggle(!t),$(".file-existing",this).toggle(t)})),$(".file-existing .file-upload-button").on("click",(function(){var t=$(this).parents(".upload-wrapper");t.find(".file-existing").remove(),t.find(".upload-field").fadeIn(500)}))},toggleCustomInputField:function(t,e,n){t&&t.hasClass("w--redirected-checked")!==n&&t.trigger("click"),e.prop("checked",n)},initEditor:function(){tinymce.init({selector:"textarea.editor",toolbar:"undo redo | bold | bullist numlist",plugins:"lists",min_height:200,max_height:400,menubar:!1,branding:!1,statusbar:!1,custom_undo_redo_levels:8,setup:function(t){let e=$(t.targetElm),n=(t,e)=>{$(t.getContainer()).parent().find(".char-count span").toggleClass("danger",e>=max).text(e)};e.addClass("editor-processed"),t.on("keydown keyup change",(function(t){let e=this,a=e.getContent({format:"text"}).length,i=$(e.getContainer()),o=Number($(e).data("data-maxlength"));if("keydown"==t.type){if(a>=o){let e="key"in t?t.key:t.keyCode;HELP.allowCommonKeyPress(t,e)||t.preventDefault()}}else console.log(1,e),console.log(2,a),console.log(3,o),console.log(4,i),n(e,a),i.parent().find(".editor-valid").remove(),a>o&&$(`<div class="editor-valid error">Enter a maximum of ${o} characters.</div>`).insertAfter(i)})).on("submit",(function(t){let e=Number($(this).data("data-maxlength"));if(this.getContent({format:"text"}).length>e)return t.preventDefault(),!1}))},init_instance_callback:function(t){let e=$(t.targetElm),n=Number(HELP.sanitizeHTML(e.attr("maxlength"))),a=$(t.getContainer());$(t).data("data-maxlength",n),n&&a.after(`<div class="char-count"><span>0</span> / ${n}</div>`).parent().addClass("char-count-wrapper")}})}};return $((function(){USER.getCurrentMember((function(t){if(HELP.checkKeyExists(t,"id")){var e=$(".input-member-id");e&&!e.val()&&(e.val(t.id),e.parents("form").find(".form-submit").removeAttr("disabled"))}}));const n=HELP.getSetQuerystring("dest");n&&$("form").find(".fp_redirect").attr("data-redirect","/"+n),$("form").on("submit",(function(){var t=$(this).find(".fp_redirect").attr("data-redirect");t&&localStorage.setItem("fp_redirect",t)})),$(".ajax-submit").on("click",".form-submit",(function(e){$(e.target).addClass("clicked"),HELP.checkKeyExists(t,"tinymce")&&tinymce.triggerSave()})).on("submit",(function(t){t.preventDefault();var e=$(this),n=e.find(".form-submit.clicked"),a=e.attr("data-validation"),i=e.attr("data-form-values-type");if(a&&!HELP.callNestedFunction(a))return console.log("Validation failed"),MAIN.buttonThinking(n,!0),!1;var o=HELP.getFormValues(e,i),r=HELP.getCookie("form-valid");r=r?Number(r):0,r=++r,"formData"==i?o.set("increment",r):o.increment=r,HELP.setCookie("form-valid",r);var l={url:e.attr("action"),method:e.attr("method"),data:o,timeout:12e4,callbackSuccess:function(t){MAIN.thinking(!1),MAIN.handleAjaxResponse(t,e)},callbackError:function(t){MAIN.thinking(!1),console.log("error")}};"formData"==i&&(l.processData=!1,l.contentType=!1,l.cache=!1),MAIN.buttonThinking(n),MAIN.thinking(!0,!1),console.log("data: ",l.data),HELP.sendAJAX(l,e)})),$(":input[data-default-value]").each((function(){var t=$(this),e=t.attr("data-default-value");t.val()||("number"==t.attr("type")&&(e=HELP.removeNonNumeric(e)),t.val(HELP.sanitizeHTML(e)))})),$(".input-default-value").each((function(){var t=$(this),e=t.text(),n=t.parent().find(":input"),i=n.eq(0).attr("type");"checkbox"==i||"radio"==i?n.each((function(){var t=$(this).siblings(`.w-${i}-input`),n=!!e&&e==$(this).val();"checkbox"==i&&(n=!!e&&"false"!==e),a.toggleCustomInputField(t,$(this),n)})):n.val()||n.val(HELP.stripHTMLWithLinebreaks(t.html()))})),$(".w-form-formradioinput--inputType-custom").each((function(){var t=$(this),e=t.siblings(":input"),n=t.hasClass("w--redirected-checked");n&&a.toggleCustomInputField(t,e,n)})),$(":input[data-maxlength]").each((function(){$(this).attr("maxlength",HELP.sanitizeHTML($(this).attr("data-maxlength")))})),$(".format-ddmmyyyy").on("keyup",(function(t){t&&"Backspace"!=t.key&&"Delete"!=t.key&&$(this).val(HELP.formatDDMMYYYY($(this).val()))})),$(".format-numeric").on("keydown",(function(t){let e="key"in t?t.key:t.keyCode;HELP.allowCommonKeyPress(t,e)||e>=0&&e<=9||t.preventDefault()})).on("change",(function(){$(this).val(HELP.removeNonNumeric($(this).val()))})),$(".format-email").on("keydown change",(function(t,e){var n=$(this).val()||"",a="key"in t?t.key:t.keyCode;n=n.toString().toLowerCase().replace(/\s+/g,"")," "!=a?(!1!==e?n=n.replace(/[^a-z0-9+\-_.@]/gi,""):/[^a-z0-9+\-_.@!()]/gi.test(n)&&(n=""),$(this).val(n.trim())):t.preventDefault()})).each((function(t,e){$(e).trigger("change",!1)})),$(".format-url").on("focus blur",(function(t){var e=$(this).val();"focus"!=t.type||e||$(this).val(HELP.addHttpProtocol(e)),"blur"==t.type&&e.length<9&&$(this).val("")})).on("keydown change",(function(t){var e=$(this).val()||"",n="key"in t?t.key:t.keyCode;(e=e.toString().toLowerCase().replace(/\s+/g,""))&&(e=HELP.addHttpProtocol(e))," "!=n?$(this).val(e):t.preventDefault()})).each((function(t,e){$(e).trigger("change")})),$('.form-submit[name="op"]').on("click",(function(){$(this).parents("form").find(".form-action-op").val($(this).val())})),HELP.waitFor(t,"Weglot",400,(function(){Weglot.on("languageChanged",(function(){$(".select-list-options").each((function(){var t=$(this).parent(".select-list-wrapper").find("select");$(this).find(".w-dyn-item").each((function(e){console.log(e,$(this).text()),t.find("option").eq(e).text($(this).text()).val($(this).data("lang-en"))})),t.hasClass("select2-hidden-accessible")&&(t.select2("destroy"),t.select2(t.data("select2-options")))}))}))})),HELP.waitFor(USER,"current.id",50,(function(){$(".select-list-options").buildSelectOptions(),$(".select2-field").filter((function(){return!$(this).parents(".select-list-wrapper").length})).createSelect2()})),$(e).on("lbox_open",(function(){})),a.uploadFields(),$(".char-count[maxlength]:not(.editor)").charCountTextareas()})),a}(jQuery,this,this.document);$.fn.buildSelectOptions=function(t){t=t||{},$.each(this,(function(t,e){var n=$(this).parent(".select-list-wrapper"),a=$("select",n),i=$(".input-default-value",n),o=i.text()?i.text():i.attr("data-value"),r=[],l=a.is("select[multiple]");o=$.trim(HELP.sanitizeHTML(o))||"",l&&(o=o.split("|")),$(this).find(".w-dyn-item").each((function(){var t=$.trim($(this).text()),e=t==o&&"selected";l&&(e=$.inArray(t,o)>-1),!t||$.inArray(t,r)>-1||(r.push(t),$(this).data("lang-en",t),$("<option />",{value:t,selected:e}).text(t).appendTo(a))})),a.trigger("change"),a.hasClass("select2-field")&&a.createSelect2()}))},$.fn.createSelect2=function(t){t=t||{};var e=this;if(!$(e).length)return!1;HELP.waitFor(jQuery,"fn.select2",100,(function(){var n;$.each(e,(function(e,a){(n=t).placeholder=$(a).attr("placeholder")||"Select...";var i=$(a).find("option[selected]");$(a).attr("multiple")||$(a).prepend('<option value="">'+HELP.sanitizeHTML(n.placeholder)+"</option>"),$(a).select2(n).data("select2-options",n).val(i.length?$(a).val():"").trigger("change")}))}))},$.fn.charCountTextareas=function(){$(this).each((function(){var t=HELP.sanitizeHTML($(this).attr("maxlength"));$(this).after(`<div class="char-count"><span>0</span> / ${t}</div>`).parent().addClass("char-count-wrapper")})),$(document).on("keyup",this,(function(t){let e=$(t.target).val().length;$(t.target).parent().find(".char-count span").toggleClass("danger",e>=Number($(t.target).attr("maxlength"))).text(e)}))},jQuery.expr[":"].selectedInput=(t,e,n)=>"checkbox"==t.type||"radio"==t.type?t.checked:["submit","button","reset","hidden"].indexOf(t.type)<0&&t.value;